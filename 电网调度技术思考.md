# 电网调度技术总结与思考

## 电网调度自动化技术概述
电网调度自动化系统又称能量管理系统(EMS)或者电网调度控制系统。该系统是电网调度控制运行的中枢，是工业软件的代表，具有极高的可靠性要求。回顾中国电网调度自动化系统的早期历史，还是有些意思的。

## 发展历史回顾
将计算机用于电网调度控制、特别是实现高级应用功能，起源于1970年，应用于美国的新英格兰电网。由于电力系统是相对成熟的行业，至70年代后期，电网调度自动化系统各项分析、优化、控制等功能都已经具备了基本功能。

我国电网调度自动化的起步很早，南京自动化研究所研制的SD-176系统，于1978年在京津唐电网得到应用，这是最早的国产电网调度自动化系统，但是只有监控功能，没有高级应用功能，还不是一个完整的EMS系统。在这一时期，浙江大学的韩祯祥教授、电科院的于尔铿教授等，对状态估计等高级应用进行了非常前瞻性的探索，为后期高级应用功能的国产化打好了理论准备。

为了进一步拉近国际先进水平，1979年到1980年，我国曾经派一个29人的团队到魁北克省水电局进修，周孝信院士是当时的成员。考察的重点是电网调度和数字仿真。国家于1982年立项购买国际先进的EMS系统。经过前期的调研、招标，于1985年与西屋公司签订合同。至1987年，四套EMS系统全部到货，应用于华北、华中、东北、华东四大电网。这就是业内人士非常熟悉的“四大网引进工程”。至1988年，四大网EMS系统通过了现场验收。

西屋公司的EMS系统型号为WESDAC-32，其中的高级应用功能，包括实时数据库平台HABITAT、网络拓扑、AGC软件由ESCA软件公司开发。ESCA软件公司到今天可能已经湮没无存了。EMTP软件的开创者Dommel博士在他的著作里提到他的朋友任西雅图ESCA公司总裁，不知道是不是同一家。

ESCA虽然现在销声匿迹了，但是却在中国EMS系统中留下了很深的印记。尤其是描述电网的层次性数据结构和网络拓扑的概念。

虽然后来的数据库技术发生了巨大的变化，但是这套层次性的数据结构留在了当前很多EMS厂家的核心计算程序中。比如说清大高科、南瑞继保、东方电子等等。真是历久弥新，这也说明了行业内真正核心的东西，真的是比很多从业人员的年龄还大的。当然，层次结构对于开发者友好，对于用户不友好，后来基本上都被关系型的数据结构取代。现在，人们又发现关系型数据库有内在的不足，因此研究新的数据结构，例如图数据库等等。这是不断发展的过程。

我国在四大电网引进中，由于外汇有限，其实只引进了实时数据库平台、SCADA、远动、AGC等功能。还有很多的高级应用功能没有引进。因此很快我国就开始开发未引进的高级应用功能，同时研制全国产的EMS系统。我刚到南瑞那会，接手的Fortran代码最早上溯到1988年，这些代码就是当时的产物。

比如说，刚引进西屋公司EMS系统的东北电网，就联合清华大学张伯明教授等人，开发实用性的状态估计和DTS仿真。考虑到当时国外电网的DTS仿真都没有很好的实用，这一成就是不容易的。还有以中国电科院于尔铿教授为代表，在多个省级电网实现了状态估计、经济调度等高级应用功能。

在全套EMS国产化方面，以南京自动化研究所的SD-6000和中国电科院CC-2000为代表，开始了全面的国产替代。

## 早期发展经验

应该说，从20世纪70年代末至90年代初，这段中国电网调度自动化系统的早期历史，从落后于国外、到引进国外技术，再到全面国产化、替代国外的技术，走了一条非常成功的道路。有哪些成功的经验呢？

1. 引进技术的过程中把握主动权，实用化验收标准是根据我国国情制订的，实用化验收是在我国技术团队的主导下进行了。直到现在，都还有发展中国家购买EMS，其验收过程委托给第三国的技术团队。甚至有的国家，其调度大楼的设计施工都外包出去，自己只负责出钱就OK了，那真是太轻松了。最近几年，我国加强了技术规范和标准的制定，甚至是国际标准的制定，这是很好的措施。

2. 以全国的市场作为筹码，要求外商转让部分技术，至少开放接口，可以针对中国特有的需求进行进一步开发。以此为机会培养国内的技术团队。如果每一个调度中心都各自为战、纷纷与外商谈判，那就不可能拿到什么优惠条件。

3. 国内的科研院所和高校有序组织技术攻关，同时也允许一定的内部竞争，快速实现国外技术的消化。开发时，可不是发些论文、搞些试点，就匆匆收兵了。而是一个持续的、闭环的过程，在实际应用中持续地解决技术问题。这一点，清华大学张伯明老师的课题组做的非常突出。

回顾历史，其实我们也可以发现一些局限性。四大网引进的数据库系统，核心建立在mmap基础上，其实可以算是最早期的内存数据库，虽然当时操作系统内核还没有epoll的概念，在并发操作上性能弱。这套数据库国产化之后完全可以开源，给社会各个部门免费应用，这样可以走上开发-应用-反馈的良性循环。而不是像现在这样，所有的行业都用redis了。类似的例子还有很多，电力系统是这么复杂，电力行业的经验和解决方案，理应对其它行业有更大的借鉴作用。我听说有飞行员退役，成立公司，指导别的行业安全生产，因为民航在安全方面有很多的经验。其实，电力系统，光是操作票制度、统一的调度指挥与控制等，都是可以推广至其它行业、乃至公共管理的。

## 电网调度技术发展规律

我国调度自动化系统的起步，以20世纪70年代中期南瑞SD-176系统的研制为标志。然后80年代从国外引进了四大能量管理系统。在此基础上吸收消化后，各个国产调度自动化系统取得了巨大成功，代表产品有南瑞的OPEN-3000系统、中国电科院的CC-2000系统、东方电子的DF8003系统等。下一代的调度自动化系统的代表是D5000，这是目前的主力产品。新一代调度技术支持系统目前仍处于试点和推广阶段。总体来说，电网调度自动化系统的发展历史，已经有半个世纪了，差不多是每隔10年更新换代一次。

本文不谈论具体的调度自动化产品，而是从更一般的角度，试图总结电网调度自动化系统的发展规律，当然，只是我个人粗浅的思考。

### 规律1 不断接入更全面的信息来解决更复杂的系统问题，实现1+1>2的效果

这个规律主要是受到中国电科院系统研究所的广告词启发，他们的标语是“您的系统所面临的问题，就是我们系统所解决的问题”，这句简直太精妙了。即宣传了系统所本身（我一直认为中国电科院系统所是中国电力科技最强的团队）同时也说明一个很强有力的道理，系统性的问题一定要用系统的方法去解决。系统的问题可能是相互耦合的，复杂和棘手程度以非线性的方式快速增长（类似于物理学的熵增）。那我们解决系统问题的方式和工具也必须是系统性的，通过1+1大于2的方式加强解决能力（物理学中的引入负熵）。这里的信息可能是多种多样的，除了传统数据，还有非结构化数据、图像、视频等。总之数据是多源的，数据多了会产生增值效益。

下面举一个小例子，信息的接入会引起解决能力的非线性增长。比如数值气象和天气预报信息的接入，不仅提高调度员的监控能力，这只是最基本的提升。同时，新能源出力和负荷的预测更精确了，可以提前进行网络分析、风险演练，调度工作由被动应对变为更有前瞻性了。天气信息可以在线动态更新线路和主变的载流量限值，可以挖掘输送能力或者预测重负荷风险。传统的静态安全分析是假设每一个N-1故障是同等概率发生的，结合气象信息（也包括其它环境监测），每个N-1故障的概率可以估算，进而升级为对电网进行更精细的风险评估。这说明，某个方面的信息接入，不仅提升某个方面的能力，而且具有全系统、全方面的连锁效益。类似的例子还有很多。

### 规律2 控制范围越大，控制的周期越长，以至于全局信息更趋于协调而不是直接的快速控制

控制（部署在安全I区）是调度自动化系统的独特功能，也是区分电网其它信息化系统的重要标志，因此有必要单独拿出来总结规律。

我们以网省系统的AVC的三级控制为例，最底层的控制是厂站级控制，控制周期最短，范围最小；中间层是二级电压控制，在分区范围内追踪中枢母线目标电压，减少无功传输；最上层是全局无功优化，实现全网的经济性最优，控制范围最大，但控制周期最长。

下面再以电网频率二次控制为例，其执行层是发电厂的AGC控制；中间层是调度中心的AGC应用，主要实现ACE偏差的控制，然后把调节量分配到各个机组；最上层需要考虑安全约束调度，安全约束调度需要考虑电网全局信息，包括灵敏度和优化潮流，给AGC提供相应的安全约束条件，合理调整发电出力，使断面潮流变化控制在允许的安全限制范围之内。安全约束调度考虑的信息范围最大，但是控制周期最长。

有人可能提出疑问，现在交直流大电网的快速发展，华东电网发生的特高压直流闭锁可能会立刻影响西北电网的频率稳定，即需要控制范围大，又需要控制周期短。事实上，这部分需求是系统保护的范畴，系统保护更像是安全稳控装置的超级放大版，技术路线与调度自动化系统是完全不同的。调度自动化系统必须参与交直流大电网的监控与事故协调处理，但其本身绝不能越俎代庖，去做系统保护去做的事情。

### 规律3 信息接入的边际收益趋近于边际成本

规律1说明了人们总是把很多的信息接入调度自动化系统，但是这种接入不可能是无限制的，总要有个边界。规律3就是边界，也就是在各种主客观因素的影响下，最终反映在经济学中的边际收益平衡上。

最近几十年，信息通信技术的发展是非常惊人的，在总体上，信息接入的成本在不断下降，这也是电网自动化技术发展的重要驱动力。但是，在具体的技术问题上，很多业内专家，尤其是学术圈的专家倾向于低估信息接入的成本。他们觉得，把测量采集装置或者传感器部署到现场，再通过通信网络送到主站就好了。实际情况远远没有这么简单。变电站有光纤通道还好一些，但是配电网和输电线路监测很多是没有光纤的，需要考虑其它的信息接入网络。除此以外，任何数据要保证可用性和准确性，必然需要投入团队去维护、考核，这里面的人力成本是不低的。

比如说，以前的配电网是很粗放的，馈线很多信息没有进入配电自动化系统。但现在不一样了，主要因素有两点：1）成本的降低，各种通信网和边缘层装置的发展（例如智能融合终端），信息接入成本降低了；2）收益提高，以前配电网没多少主动性，现在大量分布式电源、储能的发展，已经对电网产生了更强的影响，管控能力的提高可以降低风险（等于正收益），还可以用虚拟电厂等形式聚合配电和用电资源为电网服务。

如果调度自动化系统的接入规模受到限制，一个解决方式是增加边缘侧设备，业务以云边协同的方式进行。例如配电网有融合终端；变电站也不必把所有的信息都上送主站，可以在本地先处理。但是广义来说，整体二次系统（包含调度、边缘层、终端）的信息接入的边际收益仍然是趋近于边际成本。

对于某种技术路线来说，如果受到各种因素的制约，信息接入的边际收益总是小于边际成本，这种技术往往只能停留在试点、示范阶段，很难大规模的推广应用。

下面综合分析一个有趣的现象，就是关于PMU信息的接入和主站WAMS的发展。学术界往往对WAMS有非常高的期望，似乎各种神奇的应用都可以基于WAMS实现。但是现场实际的WAMS系统，往往只是对SCADA监控的一个补充，例如涉网机组参数监测、扰动识别，等等。如果SCADA数据全部打上时标，且增加采集频次，似乎WAMS系统的很多事情SCADA也可以做。总之，WAMS的实际应用往往是低于学术界的期望的。

下面给出我的一个解释，不一定准确，只是个人观点。按照规律1，接入PMU数据的工作肯定会推进的。学术界对WAMS的很多期望是基于全网快速控制，这在根本上违反了规律2。这就导致了WAMS事实上变成了SCADA的补充，其收益就有限了。然后根据规律3，PMU接入的成本也是不低的，如果收益不能覆盖成本，数据维护质量(这里指的是PMU数据)就难以得到保证。

## 调度自动化的开放性与标准化

以最近三代的调度自动化系统为例。

1. OPEN-3000系统时代，指的差不多是2001年到2011年这10年。实际上，OPEN这个单词本身就寓意着开源或者开放性，因为OPEN-3000的平台是集成实现IEC61970协议，这个协议最主要的目的是开放、互操作。很多厉害的公司或产品的名字都包含“Open”。在OPEN-3000系统的时代，集成第三方厂家，而且是嵌入式集成的（也就是第三方厂家使用OPEN-3000系统的通信总线、数据库、人机界面，而不是两个系统并列运行、定期交换数据），据我所知只有清华大学的AVC系统（清大高科开发维护）。也就是说，开放性在这个时期更多的只代表一种愿景，当然其它的调度自动化产品也差不多，这已经不适应多级调度联合处置复杂业务了。这也是国调中心下决心推动D5000研发的一个重要原因。

2. D5000系统时代，D5000是2008年开始研发，但大范围铺开是2011年以后的事情了。D5000系统采用面向服务的架构集成了多套系统和业务，开放性大大提高了。例如中国电科院的系统所、电力自动化所等单位都可以基于D5000开发自己的应用（例如在线稳定分析和调度计划），用户使用体验与南瑞自己的应用是没有区别的。甚至初创公司、民营企业都可以在D5000系统开发定制化需求的应用，例如更好的报表系统、模型维护工具等等。但是这种开放性仍然是有门槛的。即使支付了接口费用，但要在D5000系统开发应用、集成并测试，还是需要一个相当规模和水准的研发团队才可以做到。例如大多数高校课题组还是很难在D5000上开发应用的。

3. 调控云和新一代调度系统。新一代系统2018年设计，由于该系统目前仍然在试点应用阶段，我只能通过目前公布的设计思路来简单说一下。新的系统借鉴手机“应用商店”的概念，更方便的接入不同厂家开发的应用（APP），APP可以方便的下载和切换，用户还可以对同类APP评价打分。这种设计思路如果真的能实现，将极大促进电力行业的厂家竞争，用户也可以选择性价比最好、最适合的APP。

系统的开放性、互操作和兼容性很大程度上建立在标准化的基础上。当然，标准化是非常重要的，不仅有开放性这一个好处。

标准提供了一个基准，可以用来判断产品、服务或系统的质量和性能。这对用户来说都是有益的，因为他们可以有信心知道他们购买的产品将满足一定的质量标准。好的标准可以固定先进做法和经验、促进全行业的技术进步。

标准可以帮助推动创新，创新能力强、产品优秀的企业可能主导标准制定，加强竞争优势。标准还可以提高工作效率，比如说调度自动化班组不必像十多年前那样，维护操作十几种不同的系统，在不同厂家的系统中来回导数据。

下面针对标准化，提出几个不成熟的观点。

1. 标准应该引领技术进步，至少不能拖后腿。由于行业的需求不断变化，技术本身也在不断更新。建立定期的标准更新周期是有好处的。我比较熟悉ISO C++标准委员会的工作方式，他们制定IEC 14882 C++标准采用“列车模型”。也就是说，列车在预定时间出发，任何没上车的人（新的技术提案）将等待下一班，从而保证固定周期修订发布新标准（C++是每隔3年发布）。但据我所知，应该没有哪个电力标准发布是采用这种方式。

2. 标准应该使用主流成熟的技术，但并不意味着不会走弯路。也就是说，标准本身完全可能存在商榷的部分，需要不断修订。例如，XML技术在几十年间被普遍认同为标准文本交换格式，这可能是走了弯路，XML在实践中存在巨大的问题。无论是IEC61970协议，还是IEC61850协议，最初的模型都采用XML格式。十几年前，我调试OPEN-3000外网等值应用，当时用的是CIM/XML格式。为了调试，不得不一行行读XML文件，然后在白纸上绘制电网结构图，那种繁琐程度至今记忆犹新。IEC61850协议的SCD文件，动辄几十兆，已经不是人类能轻易阅读了。所以国调推出CIM/E格式文件代替了CIM/XML文件。类似的问题还有很多，例如IEC61850协议的MMS协议是过时的，非常不好用，新一代的国产变电站设备也将替代这个协议。再比如说，曾经有的电网公司试图基于SOAP建立多业务集成的调度系统，但SOAP协议在性能、可操作性等方面存在很多问题，可能需要修订。

3. 标准不能无原则地使用过于时髦的技术，要从实际业务出发而不是新潮出发。很多流行的名词，可能1年多时间就过时了，也未必真的符合业务需求。比如说，前段时间中台的概念非常流行，很多专家言必称中台，任何信息化系统如果不上中台那就落伍了。于是，我看到很多电力信息化系统的新标准以中台为核心。但是最近，中台的概念似乎一下子就销声匿迹了，因为很多行业用了中台都出现水土不服的现象，说明这个理念是有问题的，至少适用面没有预期的广泛。可是，那么多基于中台的标准规范怎么办，一个个慢慢修订，还是放在那里不管呢？

4. 标准不能脱离实际，不能太过前瞻。有的标准包罗万象，但是过于繁杂，或者理念过于超前，忽略了工程实施的可行性和经济性。以至没有一个厂家实现了这样的标准。这种标准迈的步子就太大了。毕竟标准不是学术论文，学术论文可以纯理论探讨，不考虑工程落地的问题，但标准不同。

5. 电力行业中，企业主导标准制定的重要性可能会提高。目前的电力行业竞争相对不充分，几乎没有发明专利侵权诉讼。下面介绍通信行业的情况，通信器件外观专利是比较容易收集证据的，但是很多核心算法是软件实现的，这些核心技术应该怎么维护发明权利呢？实际上是通过标准，主流的厂商会推动行业标准使用自己的专利。这样别的厂家遵循标准的同时，就默认自己用到了别人的专利，需要支付专利费。

电力行业开放性不断提高，不断有互联网公司、初创企业进入电力行业；也随着电力行业改革，别的行业(例如综合能源等领域)也不断参与电力业务。可以预期，技术竞争将在未来加剧。到那个时候，标准制定也许可能真的会出现通信行业那种“剑拔弩张”的气氛。